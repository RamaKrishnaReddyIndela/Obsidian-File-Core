# MongoDB Collections Analysis - FortiCrypt2

Based on your MongoDB Compass screenshot and codebase analysis, here's what each collection should contain:

## 📊 Current Database State
From your screenshot, these collections are **EMPTY**:
- ❌ `blockchainrecords` - 0 documents
- ❌ `histories` - 0 documents  
- ❌ `otps` - 0 documents

## 🔍 Why These Collections Are Empty

### 📚 `histories` Collection
**Status: EMPTY (This is NORMAL!)**
- **Purpose**: Legacy history tracking (not actively used)
- **Why Empty**: Your system uses `activities` collection instead
- **Model**: `History.js` exists but not actively populated
- **Recommendation**: **Ignore this collection** - check `activities` instead

### 📧 `otps` Collection  
**Status: EMPTY (Normal until OTP requests are made)**
- **Purpose**: Store temporary email verification codes
- **Populated When**: 
  - Users request email verification in profile
  - Password reset initiated
  - Two-factor authentication
- **TTL**: OTPs auto-expire after 5-10 minutes
- **To Generate Data**: 
  1. Go to profile settings
  2. Change email and click "Send OTP"
  3. Check MongoDB - should see new OTP record

### ⛓️ `blockchainrecords` Collection
**Status: EMPTY (Normal until blockchain features are used)**
- **Purpose**: Store dedicated blockchain verification records
- **Populated When**: Files are recorded on blockchain (separate from File model)
- **Why Might Be Empty**: 
  - Blockchain data stored in `File.blockchain` field instead
  - No blockchain recording triggered yet
  - Feature not actively used
- **To Generate Data**: Upload files with blockchain recording enabled

## ✅ Collections That SHOULD Have Data

Based on your system design, these collections should contain data:

### 👥 `users` Collection
- **Should contain**: User accounts, profiles, authentication data
- **Check this first** - if empty, create admin user

### 📁 `files` Collection  
- **Should contain**: Uploaded encrypted files metadata
- **Generated by**: File upload operations
- **Contains**: File paths, encryption keys, blockchain references

### 🎯 `activities` Collection (**This replaces `histories`**)
- **Should contain**: User activity logs, file operations
- **Generated by**: All user actions (upload, encrypt, decrypt, etc.)
- **This is your main activity tracking**

### 🔐 `secrets` Collection
- **Should contain**: Encrypted secrets from vault feature
- **Generated by**: Using the Secret Vault functionality

## 🚀 How to Generate Real Data

### For `activities` (Main Activity Log):
```bash
1. Upload files through the web interface
2. Encrypt/decrypt files  
3. Use AI/ML scanning features
4. Change password
5. Any user action will create activity records
```

### For `otps`:
```bash
1. Login to application
2. Go to profile settings  
3. Try to change email address
4. Click "Send OTP" button
5. Check MongoDB - should see OTP record
```

### For `blockchainrecords`:
```bash
1. Upload files with blockchain recording enabled
2. Use blockchain verification features
3. Check if blockchain data is stored in File.blockchain instead
```

## 🔧 Database Health Check Commands

Run these in MongoDB Compass console:

```javascript
// Check users
db.users.countDocuments()

// Check files  
db.files.countDocuments()

// Check activities (main activity log)
db.activities.countDocuments()

// Check if activities exist
db.activities.find().limit(5)

// Check recent activities
db.activities.find().sort({timestamp: -1}).limit(10)
```

## 🎯 Next Steps

1. **Check `activities` collection** - This is your main activity log
2. **Upload a test file** - Should populate `files` and `activities`
3. **Try OTP verification** - Should populate `otps` temporarily
4. **Ignore `histories`** - It's not actively used in your system

## 💡 Summary

Your empty collections are **NORMAL** because:
- `histories` → Replaced by `activities`
- `otps` → Only populated during active verification (temporary)  
- `blockchainrecords` → Only if blockchain features are actively used

**Focus on `activities`, `files`, and `users` collections for real data!**